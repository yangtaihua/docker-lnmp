
version: "2"
services:

    docker-nginx:
        container_name: docker-nginx
        build: ./nginx
        image: yangtaihua/nginx:1.15.9-alpine
        volumes:
            - ./sites:/var/www/html
            - ./nginx/conf.d/app.conf:/etc/nginx/conf.d/app.conf:ro
        ports:
            - "80:80"
        depends_on:
            - docker-php
        links:
            - docker-php
    docker-php:
        container_name: docker-php
        build: ./php
        image: yangtaihua/php-fpm:5.6
        environment:
                    XDEBUG_CONFIG: remote_host=192.168.3.5 remote_port=9001
        volumes:
            - ./sites:/var/www/html
            - ./php/php.ini:/usr/local/etc/php/php.ini
            - ./php/php-fpm.d/app.conf:/usr/local/etc/php-fpm.d/app.conf
        ports:
            - "1022:22"
            - "9000:9000"
            - "3306:3306"
        depends_on:
          - docker-redis
        links:
          - docker-redis
    docker-redis:
        container_name: docker-redis
        build: ./redis
        image: yangtaihua/redis:5.0.3-alpine
        volumes:
            - ./redis/redis.conf:/home/redis.conf
        ports:
            - "16379:6379"


